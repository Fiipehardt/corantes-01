<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Conferência de Estoque — Simples (Qtd em vermelho/negrito)</title>
  <style>
    :root{
      --bg:#0f172a;        /* slate-900 */
      --card:#111827;      /* gray-900 */
      --muted:#94a3b8;     /* slate-400 */
      --text:#e5e7eb;      /* gray-200 */
      --soft:#1f2937;      /* gray-800 */
      --line:#374151;      /* gray-700 */
      --btn:#2563eb;       /* blue-600 */
      --accent:#22c55e;    /* green-500 */
      --warn:#f59e0b;      /* amber-500 */
      --danger:#ef4444;    /* red-500 */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--text);
      font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;
      -webkit-tap-highlight-color: transparent;
    }
    header{
      position:sticky; top:0; z-index:10;
      background:linear-gradient(180deg, rgba(15,23,42,0.98), rgba(15,23,42,0.9));
      backdrop-filter: blur(6px);
      border-bottom:1px solid var(--line);
    }
    .wrap{max-width:860px; margin:0 auto; padding:12px 14px}
    h1{font-size:18px; margin:4px 0 10px 0}
    .row{ display:flex; gap:8px; flex-wrap:wrap; align-items:center }
    input[type="text"], input[type="number"], textarea{
      background:var(--soft); color:var(--text); border:1px solid var(--line);
      border-radius:12px; padding:12px 14px; outline:none; width:100%; font-size:16px;
    }
    input[type="number"]{
      -moz-appearance:textfield; appearance:textfield;
      touch-action: manipulation;
    }
    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    /* Qtd em vermelho e negrito */
    .qty{
      color: var(--danger);
      font-weight: 800;
    }
    .btn{
      background:var(--btn); color:white; border:none; padding:12px 14px;
      border-radius:999px; cursor:pointer; font-weight:700; font-size:15px;
    }
    .btn.secondary{ background:var(--soft); border:1px solid var(--line); color:var(--text) }
    .btn.warn{ background:var(--warn) }
    .btn.danger{ background:var(--danger) }
    .btn.accent{ background:var(--accent) }
    .btn.small{ padding:8px 12px; font-size:14px }
    main{ padding:14px }
    .card{
      background:var(--card); border:1px solid var(--line);
      border-radius:16px; padding:10px 10px; margin-bottom:10px;
    }
    .list{ display:grid; gap:8px }
    .item{
      display:grid;
      grid-template-columns: 1fr 0.7fr;
      gap:8px; align-items:center;
      padding:10px; border:1px dashed var(--line); border-radius:12px;
      background:rgba(255,255,255,0.02);
    }
    .ref{ font-weight:800; letter-spacing:.2px }
    .tag{ font-size:12px; opacity:.8 }
    .help{ font-size:12px; color:var(--muted) }
    .footer{
      position:sticky; bottom:0; background:linear-gradient(0deg, rgba(15,23,42,0.98), rgba(15,23,42,0.9));
      border-top:1px solid var(--line); padding:10px 14px;
    }
    .footer .row{ justify-content:space-between }
    .orderArea{
      width:100%; min-height:140px; padding:10px; border-radius:12px;
      background:var(--soft); color:var(--text); border:1px solid var(--line);
    }
    @media print{
      header,.footer,.controls{ display:none !important }
      body{ background:white; color:black }
      .card{ border:none }
      .item{ border:1px solid #ccc }
      .qty{ color:#c00; } /* garante vermelho na impressão */
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Conferência de Estoque — Simples</h1>
      <div class="row">
        <input id="search" type="text" placeholder="Buscar (ex.: 96-7.11, G, ANETA)" autocomplete="off" />
        <button class="btn secondary" id="clearSearch">Limpar</button>
      </div>
      <div class="help" style="margin-top:6px">
        Digite <b>apenas a quantidade</b> que você tem. Os dados ficam salvos neste dispositivo.
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="card">
      <div class="list" id="list"></div>
    </div>

    <div class="card">
      <div class="row" style="justify-content:space-between; gap:8px; flex-wrap:wrap">
        <button class="btn accent" id="genList">Gerar lista preenchida</button>
        <button class="btn secondary" id="printPage">Imprimir</button>
        <button class="btn warn" id="resetQty">Zerar quantidades</button>
        <button class="btn danger" id="resetAll">Apagar tudo</button>
      </div>
      <div style="margin-top:10px">
        <textarea id="output" class="orderArea" placeholder="A lista aparecerá aqui…"></textarea>
      </div>
      <div class="row" style="margin-top:8px; gap:8px">
        <button class="btn secondary small" id="copyList">Copiar</button>
        <button class="btn small" id="whatsList">Enviar no WhatsApp</button>
      </div>
    </div>
  </main>

  <div class="footer">
    <div class="wrap">
      <div class="row">
        <div class="help">Itens listados: <span id="countShown">0</span> • Itens com quantidade &gt; 0: <span id="countFilled">0</span></div>
        <div class="help">Salvo localmente • Funciona offline</div>
      </div>
    </div>
  </div>

<script>
const DATA = [
  // Referências numéricas com etiqueta (letra)
  { ref:"96-7.11", tag:"G" },
  { ref:"96-26.11", tag:"Z" },
  { ref:"96-3.11", tag:"C" },
  { ref:"96-5.11", tag:"E" },
  { ref:"96-23.04", tag:"W" },
  { ref:"96-12.11", tag:"L" },
  { ref:"96-2.11", tag:"B" },
  { ref:"96-4.11", tag:"D" },
  { ref:"96-13.11", tag:"M" },
  { ref:"96-6.11", tag:"F" },
  { ref:"96-10.11", tag:"J" },
  { ref:"96-22.11", tag:"V" },

  // Itens ANETA por letra
  { ref:"C", tag:"ANETA" },
  { ref:"G", tag:"ANETA" },
  { ref:"B", tag:"ANETA" },
  { ref:"L", tag:"ANETA" },
  { ref:"M", tag:"ANETA" },
  { ref:"Z", tag:"ANETA" },
  { ref:"V", tag:"ANETA" },
  { ref:"J", tag:"ANETA" },
  { ref:"F", tag:"ANETA" },
  { ref:"E", tag:"ANETA" },
  { ref:"D", tag:"ANETA" },
  { ref:"W", tag:"ANETA" },
];

// Storage
const KEY = "estoque_ref_simple_v1"; // mantém o mesmo para aproveitar dados já salvos
function loadState(){ try { return JSON.parse(localStorage.getItem(KEY)) || {}; } catch(e){ return {}; } }
function saveState(s){ localStorage.setItem(KEY, JSON.stringify(s)); }
let state = loadState();

// Elements
const listEl = document.getElementById("list");
const searchEl = document.getElementById("search");
const clearSearchEl = document.getElementById("clearSearch");
const countShownEl = document.getElementById("countShown");
const countFilledEl = document.getElementById("countFilled");
const outputEl = document.getElementById("output");

function getItemKey(item){ return `${item.ref}__${item.tag}`; }
function getQty(item){
  const k = getItemKey(item);
  const s = state[k]; 
  const q = s && Number.isFinite(+s.qty) ? +s.qty : 0;
  return q;
}
function setQty(item, qty){
  const k = getItemKey(item);
  state[k] = { qty: Math.max(0, parseInt(qty||"0", 10)) };
  saveState(state);
  updateCounts();
}

function render(){
  const q = searchEl.value.trim().toLowerCase();
  listEl.innerHTML = "";
  let shown = 0;
  DATA.forEach(item=>{
    const txt = (item.ref + " " + item.tag).toLowerCase();
    if(q && !txt.includes(q)) return;

    const row = document.createElement("div");
    row.className = "item";

    const left = document.createElement("div");
    const title = document.createElement("div");
    title.className = "ref";
    title.textContent = item.ref;
    const sub = document.createElement("div");
    sub.className = "tag";
    sub.textContent = item.tag;
    left.appendChild(title);
    left.appendChild(sub);

    const qty = document.createElement("input");
    qty.type = "number"; qty.inputmode="numeric"; qty.min="0"; qty.step="1";
    qty.className = "qty";
    qty.value = getQty(item);
    qty.title = "Quantidade";
    qty.addEventListener("focus", ()=>{ qty.select(); });
    qty.oninput = (e)=>{
      const v = Math.max(0, parseInt(e.target.value||"0",10));
      e.target.value = v;
      setQty(item, v);
    };

    row.appendChild(left);
    row.appendChild(qty);
    listEl.appendChild(row);
    shown++;
  });
  countShownEl.textContent = shown;
  updateCounts();
}

function updateCounts(){
  const filled = DATA.filter(it=> getQty(it) > 0).length;
  countFilledEl.textContent = filled;
}

// Export helpers
function generateList(){
  const lines = [];
  lines.push("** Conferência de Estoque — Quantidades **");
  const now = new Date();
  lines.push("Data: " + now.toLocaleString());
  lines.push("");
  let any = false;
  DATA.forEach(item=>{
    const q = getQty(item);
    if(q>0){
      any = true;
      lines.push(`${item.ref} (${item.tag}) — Qtd: ${q}`);
    }
  });
  if(!any) lines.push("Nenhum item preenchido.");
  return lines.join("\n");
}

// Events
searchEl.addEventListener("input", render);
clearSearchEl.addEventListener("click", ()=>{ searchEl.value=""; render(); });

document.getElementById("genList").addEventListener("click", ()=>{
  outputEl.value = generateList();
  outputEl.focus();
  outputEl.select();
});
document.getElementById("copyList").addEventListener("click", async ()=>{
  if(!outputEl.value) outputEl.value = generateList();
  try{
    await navigator.clipboard.writeText(outputEl.value);
    alert("Lista copiada para a área de transferência.");
  }catch(e){
    alert("Não foi possível copiar automaticamente. Selecione e copie manualmente.");
  }
});
document.getElementById("whatsList").addEventListener("click", ()=>{
  if(!outputEl.value) outputEl.value = generateList();
  const msg = encodeURIComponent(outputEl.value);
  const url = `https://wa.me/?text=${msg}`;
  window.open(url, "_blank");
});
document.getElementById("printPage").addEventListener("click", ()=> window.print());

document.getElementById("resetQty").addEventListener("click", ()=>{
  if(!confirm("Zerar todas as quantidades?")) return;
  DATA.forEach(item=>{
    const k = getItemKey(item);
    state[k] = { qty: 0 };
  });
  saveState(state);
  render();
});
document.getElementById("resetAll").addEventListener("click", ()=>{
  if(!confirm("Apagar TUDO (quantidades salvas)?")) return;
  localStorage.removeItem(KEY);
  state = loadState();
  render();
});

// Init
render();
</script>
</body>
</html>
